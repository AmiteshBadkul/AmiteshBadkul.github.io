<!DOCTYPE html> <html lang="en"> <head> <meta name="google-site-verification" content="google-site-verification=google5d0dde76b59b2bd0.html"/> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Learnings from Molecular Dynamic Simulation | Amitesh Badkul</title> <meta name="author" content="Amitesh Badkul"/> <meta name="description" content="understanding simple MD simulations"/> <meta name="keywords" content="deep learning, bioinformatics, machine learning, image processing"/> <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha256-DF7Zhf293AJxJNTmh5zhoYYIMs2oXitRfBjY+9L//AY=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"/> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css" integrity="sha256-mUZM63G8m73Mcidfrv5E+Y61y7a12O5mW4ezU3bxqW4=" crossorigin="anonymous"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.1/css/academicons.min.css" integrity="sha256-i1+4qU2G2860dGGIOJscdC30s9beBXjFfzjWLjBRsBg=" crossorigin="anonymous"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/github.css" media="" id="highlight_theme_light"/> <link rel="shortcut icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üí≠</text></svg>"> <link rel="stylesheet" href="/assets/css/main.css"> <link rel="canonical" href="https://amiteshbadkul.github.io/blog/2022/md-simulation/"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jwarby/jekyll-pygments-themes@master/native.css" media="none" id="highlight_theme_dark"/> <script src="/assets/js/theme.js"></script> <script src="/assets/js/dark_mode.js"></script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="https://amiteshbadkul.github.io/"><span class="font-weight-bold">Amitesh¬†</span>Badkul</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications</a> </li> <li class="nav-item "> <a class="nav-link" href="/projects/">projects</a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories</a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv</a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fas fa-moon"></i> <i class="fas fa-sun"></i> </button> </li> </ul> </div> </div> </nav> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">Learnings from Molecular Dynamic Simulation</h1> <p class="post-meta">March 17, 2022</p> <p class="post-tags"> <a href="https://amiteshbadkul.github.io/blog/2022"> <i class="fas fa-calendar fa-sm"></i> 2022 </a> ¬† ¬∑ ¬† <a href="//blog/tag/md"> <i class="fas fa-hashtag fa-sm"></i> md</a> ¬† <a href="//blog/tag/vmd"> <i class="fas fa-hashtag fa-sm"></i> vmd</a> ¬† <a href="//blog/tag/namd"> <i class="fas fa-hashtag fa-sm"></i> namd</a> ¬† ¬† ¬∑ ¬† <a href="https://amiteshbadkul.github.io/blog/category/molecular-dynamics"> <i class="fas fa-tag fa-sm"></i> molecular-dynamics</a> ¬† </p> </header> <article class="post-content"> <h2 id="introduction">Introduction</h2> <p>To understand the process of creating and running a molecular dynamic simulation using <a href="https://www.ks.uiuc.edu/Research/namd/" target="_blank" rel="noopener noreferrer">NAMD</a> and <a href="https://www.ks.uiuc.edu/Research/vmd/" target="_blank" rel="noopener noreferrer">VMD</a>, I ran a simple simulation of a water box. The first half of the post discusses MD Simulations and their sophistication and intricacies. The second half discusses creating and simulating a water box using a high-performance computing cluster.</p> <h2 id="computer-simulations">Computer Simulations</h2> <p>Computer simulations help us better analyze the properties of molecular assemblies in terms of microscopic interactions and structure of the same. This works as a supplement to traditional experiments, empowering us to learn something new that we couldn‚Äôt learn any other way. Molecular dynamics (MD) and Monte Carlo are the most common simulation techniques (MC). Computer simulations help link time scales and the microscopic length with the macroscopic world in the laboratory. It provides a view of the interactions among molecules and obtains accurate predictions of the bulk properties. Molecular dynamics (MD) is a procedure where the motion of the particles of a system over a specific period is recorded by solving Newton‚Äôs equations of motion. This is done for each particle in the system over the simulation duration. However, the MD simulation method was introduced in the 1950s by Marshall Rosenbluth and Nicholas Metropolis in the form of the Metropolis-Hastings algorithm.</p> <table> <thead> <tr> <th style="text-align: center"><img src="https://upload.wikimedia.org/wikipedia/commons/7/7b/Molecular_dynamics_algorithm.png" width="50%" height="50%"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>The general procedure for MD Simulation is illustrated</em></td> </tr> </tbody> </table> <h3 id="namd">NAMD</h3> <p>NAMD was first introduced by Nelson et al., who was part of the theoretical biophysics group, in the year 1995. It was implemented and created using C++. Currently, the theoretical biophysics group and the parallel programming laboratory at the University of Illinois develop, upgrade, and maintain NAMD. NAMD is used to perform dynamic molecular simulations. For any simulation, the input files required and their description are given below.</p> <ol> <li>PDB (Protein Data Bank) - Contains information on the coordinates of atoms of the Protein</li> <li>PSF (Protein Structure File) - Contains all the information necessary to convert a list of residual names into a complete PSF structure file. Aids with the automatic designation of hydrogen atoms to the protein</li> <li>Topology file - Contains all the molecular-specific information needed to apply a particular force field to the molecular system</li> <li>Parameter file - Contains all the numerical constants necessary to evaluate energies, forces, speed, and position of the atoms of the protein</li> </ol> <h3 id="vmd">VMD</h3> <p>The theoretical and computational biophysics group established VMD under the supervision of Klaus Schulten. VMD has Tcl (a high-level programming language) and Python interpreters. VMD is used along with NAMD to visualize the proteins and the steps involved in the simulation. The theoretical and computational biophysics group currently maintains it. VMD recognizes various files of molecular data for visualization purposes. The list below gives more information about the same.</p> <ol> <li>Protein Data Bank files</li> <li>X-PLOR and Chemistry at Harvard Macromolecular Mechanics (CHARMM) PSF files</li> <li>X-PLOR and Chemistry at Harvard Macromolecular Mechanics (CHARMM) trajectory DCD files</li> <li>X-PLOR and Chemistry at Harvard Macromolecular Mechanics (CHARMM) trajectory DCD files</li> <li>Assisted Model Building with Energy Refinement (AMBER) trajectory and structure files</li> <li>GROningen MAchine for Chemical Simulations (GROMACS) trajectory and structure files</li> </ol> <h2 id="molecular-dynamics-simulation">Molecular Dynamics Simulation</h2> <p>Computer simulations help us better analyze the properties of molecular assemblies in terms of microscopic interactions and structure of the same. This works as a supplement to traditional experiments, empowering us to learn something new that we couldn‚Äôt learn any other way. Molecular dynamics (MD) and Monte Carlo are the most common simulation techniques (MC). Computer simulations help link time scales and the microscopic length with the macroscopic world in the laboratory. It provides a view of the interactions among molecules and obtains accurate predictions of the bulk properties. Molecular dynamics (MD) is a procedure where the motion of the particles of a system over a specific period is recorded by solving Newton‚Äôs equations of motion. This is done for each particle in the system over the simulation duration.</p> <p>Characteristics of Molecular Dynamic Simulation include the following:</p> <ol> <li>It is a deterministic technique</li> <li>It only takes into consideration the the intermolecular forces and the starting position of each particle in the system</li> <li>It can be successfully be used as a statistical mechanics method</li> <li>The data recorded about the distances and the velocities can be averaged over time and over all the molecules of the system to obtain the thermodynamic quantities of the system</li> <li>It provides atomic and molecular level information on the system</li> </ol> <table> <thead> <tr> <th style="text-align: center"><img src="https://i.imgur.com/zXjH2ec.png" width="70%"></th> </tr> </thead> <tbody> <tr> <td style="text-align: center"><em>The Steps Involved in Molecular Dynamic Simulation</em></td> </tr> </tbody> </table> <p>The main disadvantage of Molecular Dynamic Simulation is that the result is often an approximate measure because solving the Schrodinger equation to obtain the wavefunction that accurately describes atom/particle is computationally expensive and time-consuming. However, the error obtained from simulation can be minimized by choosing the correct potential function. A wide range of potential functions makes the simulation results realistic and more precise.</p> <h3 id="the-algorithm">The Algorithm</h3> <p>Newton‚Äôs equation of motions are solved for all the system particles for all molecular dynamic simulations.</p> <p>As input we need only the following:</p> <ol> <li>The starting set of coordinates of the atoms of a system.</li> <li>The set of potential functions for obtaining the forces among various atoms/particles of the system.</li> </ol> <p>The five quintessential components for any Molecular Dynamic Simulation are initial condition, boundary condition, integrator/ensemble, force calculation, and property calculation. The distinct properties calculated include - dynamic structure factor and thermal conductivity, the viscosity of the system particles, internal energy, free energy, enthalpy, and many more. The various potentials include - the Lennard-Jones potential Coulomb‚ÄìBuckingham potential.</p> <h4 id="lennard-jones-potential">Lennard-Jones Potential</h4> <p>It is an intermolecular pair potential. Among all the intermolecular pairs, researchers have extensively examined the Lennard-Jones potential.</p> <p align="center" width="100%"> <img width="50%" src="https://upload.wikimedia.org/wikipedia/commons/9/93/12-6-Lennard-Jones-Potential-equation.svg"><br> <i> Lennard-Jones Potential Expression </i> </p> <p align="center" width="100%"> <img width="50%" src="https://upload.wikimedia.org/wikipedia/en/e/e7/Graph_of_Lennard-Jones_potential.png"><br> <i> Lennard-Jones Potential Graph </i> </p> <h4 id="coulombbuckingham-potential">Coulomb‚ÄìBuckingham Potential</h4> <p>It is a modification of the Buckingham Potential, which was put forth by Richard Buckingham. For the application of the Buckingham potential to ionic systems, the modification was made, and hence the new potential came to be known as Coulomb-Buckingham Potential.</p> <p align="center" width="100%"> <img width="50%" src="https://wikimedia.org/api/rest_v1/media/math/render/svg/80e3fc27abeca3b8e89135ee679c5c10bdedc9d1"><br> <i> Coulomb‚ÄìBuckingham Potential Expression </i> </p> <p align="center" width="100%"> <img width="50%" src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Coulomb-Buckingham_Potential.png"><br> <i> Coulomb‚ÄìBuckingham Potential Graph </i> </p> <h2 id="water-box-simulation">Water Box Simulation</h2> <p>The water box is modelled by utilizing the VMD software. We use the ‚ÄúAdd Solvation Box‚Äù command to generate the water box. The command can be accessed as follows:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">VMD</span> <span class="o">&gt;</span> <span class="n">Extensions</span> <span class="o">&gt;</span> <span class="n">Modeling</span> <span class="o">&gt;</span> <span class="n">Add</span> <span class="n">Solvation</span> <span class="n">Box</span>
</code></pre></div></div> <p>The command generates the PDB (Protein Data Bank) and the PSF (Protein Structure File) for the water box after taking in the coordinates of the box, for our case we provide 40nm as the length of our water box, centered at (0, 0, 0). The diagram below depicts the PDB of water box generated as displayed by VMD.</p> <p align="center" width="100%"> <img width="50%" src="https://i.imgur.com/bObWAFi.png"><br> <i> Water Cube </i> </p> <p>The first few lines of the PDB file for the water box:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CRYST1</span>   <span class="mf">40.000</span>   <span class="mf">40.000</span>   <span class="mf">40.000</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span>  <span class="mf">90.00</span> <span class="n">P</span> <span class="mi">1</span>           <span class="mi">1</span>
<span class="n">ATOM</span>      <span class="mi">1</span>  <span class="n">OH2</span> <span class="n">TIP3W</span>   <span class="mi">5</span>     <span class="o">-</span><span class="mf">16.332</span>  <span class="o">-</span><span class="mf">9.918</span>  <span class="o">-</span><span class="mf">4.096</span>  <span class="mf">1.00</span>  <span class="mf">0.00</span>      <span class="n">WT1</span>  <span class="n">O</span>
<span class="n">ATOM</span>      <span class="mi">2</span>  <span class="n">H1</span>  <span class="n">TIP3W</span>   <span class="mi">5</span>     <span class="o">-</span><span class="mf">16.776</span>  <span class="o">-</span><span class="mf">9.549</span>  <span class="o">-</span><span class="mf">4.899</span>  <span class="mf">1.00</span>  <span class="mf">0.00</span>      <span class="n">WT1</span>  <span class="n">H</span>
<span class="n">ATOM</span>      <span class="mi">3</span>  <span class="n">H2</span>  <span class="n">TIP3W</span>   <span class="mi">5</span>     <span class="o">-</span><span class="mf">16.908</span>  <span class="o">-</span><span class="mf">9.621</span>  <span class="o">-</span><span class="mf">3.373</span>  <span class="mf">1.00</span>  <span class="mf">0.00</span>      <span class="n">WT1</span>  <span class="n">H</span>
<span class="n">ATOM</span>      <span class="mi">4</span>  <span class="n">OH2</span> <span class="n">TIP3W</span>   <span class="mi">7</span>     <span class="o">-</span><span class="mf">13.967</span> <span class="o">-</span><span class="mf">15.124</span>   <span class="mf">0.891</span>  <span class="mf">1.00</span>  <span class="mf">0.00</span>      <span class="n">WT1</span>  <span class="n">O</span>
<span class="n">ATOM</span>      <span class="mi">5</span>  <span class="n">H1</span>  <span class="n">TIP3W</span>   <span class="mi">7</span>     <span class="o">-</span><span class="mf">13.922</span> <span class="o">-</span><span class="mf">14.776</span>   <span class="mf">1.798</span>  <span class="mf">1.00</span>  <span class="mf">0.00</span>      <span class="n">WT1</span>  <span class="n">H</span>
<span class="n">ATOM</span>      <span class="mi">6</span>  <span class="n">H2</span>  <span class="n">TIP3W</span>   <span class="mi">7</span>     <span class="o">-</span><span class="mf">13.408</span> <span class="o">-</span><span class="mf">15.912</span>   <span class="mf">0.961</span>  <span class="mf">1.00</span>  <span class="mf">0.00</span>      <span class="n">WT1</span>  <span class="n">H</span>    
</code></pre></div></div> <p>Now that the PDB and the PSF files are ready, we need to create the configuration file that NAMD uses to set parameters for the MD simulation that needs to be run. The various parameters necessary for running a simulation are - structure file, coordinate file, temperature, restartfreq, dcdfreq, xstFreq, outputEnergies, force-field parameters, cutoff, stepspercycle, timestep, langevin, langevinDamping, langevinTemp, langevinHydrogen, periodic boundary conditions, particle mesh Ewald (PME), langevinPiston, langevinPistonTarget, langevinPistonPeriod, langevinPistonDecay, langevinPistonTemp, minimize, and run.</p> <p>This section explores each of these parameters in detail.</p> <ol> <li>Structure - This takes as input the relative location of the structure file, in our case the PSF file generated by VMD. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">structure</span>       <span class="p">..</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">solvate</span><span class="p">.</span><span class="n">psf</span>
</code></pre></div> </div> </li> <li>Coordinates - Just like the structure parameter, this takes the relative location of the PDB file, which the coordinates of the structure. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">coordinate</span>      <span class="p">..</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">solvate</span><span class="p">.</span><span class="n">pdb</span>
</code></pre></div> </div> </li> <li>Temperature - Sets the temperature for the MD simulation (in Kelvin). <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">temperature</span>     <span class="mi">300</span>
</code></pre></div> </div> </li> <li>. Restart Frequency, DCD Frequency, XST Frequency, Output Energies - The frequency with which the restart files, DCD (coordinates), and the XST (velocity) files are generated. Output Energies rewrites the output files every fixed number of steps. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">restartfreq</span>     <span class="mi">1000</span> <span class="c1"># 1000 steps = 2ps
</span><span class="n">dcdfreq</span>         <span class="mi">1000</span>
<span class="n">xstFreq</span>         <span class="mi">1000</span>
<span class="n">outputEnergies</span>  <span class="mi">150</span>
</code></pre></div> </div> </li> <li>Force Field Parameters - paraTypeCharmm and parameters - The paraTypeCharmm parameter checks whether the parameters file is CHARMM type, and the parameter keyword takes the relative location of the force field parameter file. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">paraTypeCharmm</span>  <span class="n">on</span>
<span class="n">parameters</span>      <span class="p">..</span><span class="o">/</span><span class="nb">input</span><span class="o">/</span><span class="n">par_all27_prot_lipid</span><span class="p">.</span><span class="n">inp</span>
</code></pre></div> </div> </li> <li>Cutoff - NAMD effectively removes the Van Der Waal forces of interaction by the specified cutoff value. The Fig. 2.2 illustrates the working of the Cutoff parameter. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">cutoff</span>          <span class="mi">10</span>
</code></pre></div> </div> </li> <li>Steps per cycle - The total number of steps taken for completion of one cycle is specified by the stepspercycle parameter. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">stepspercycle</span>   <span class="mi">5</span>
</code></pre></div> </div> </li> </ol> <p align="center" width="100%"> <img width="50%" src="https://www.ks.uiuc.edu/Research/namd/2.10/ug/img74.png"><br> <i> Illustration of the working of the Cutoff parameter </i> </p> <ol> <li>Time Step - The time taken to complete one step, specified in femtoseconds. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">timestep</span>        <span class="mf">2.0</span>
</code></pre></div> </div> </li> <li>Temperature Control Parameters - The ‚Äòlangevin‚Äô parameter specifies whether the Langevin dynamics are to be utilized. ‚ÄòlangevinDamping‚Äô specifies the damping coefficient for the said dynamics. ‚ÄòlangevinTemp‚Äô states the temperature in Kelvin for langevin dynamics. ‚ÄòlangevinHydrogen‚Äô tells NAMD whether to apply Langevin dynamics to hydrogen atoms present. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">langevin</span>         <span class="n">on</span>
<span class="n">langevinDamping</span>  <span class="mi">1</span>
<span class="n">langevinTemp</span>     <span class="mi">300</span>
<span class="n">langevinHydrogen</span> <span class="n">no</span>
</code></pre></div> </div> </li> <li>Periodic Boundary Conditions - The parameters cellBasisVector1, cellBasisVector2, and cellBasisVector3 state the length of the repeating units. This is implemented to avoid the finite size problem and to make the system an infinite one for smoother simulation. cellOrigin - takes as input the center/origin of the simulation. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">cellBasisVector1</span> <span class="mi">40</span>   <span class="mi">0</span>   <span class="mi">0</span>
<span class="n">cellBasisVector2</span> <span class="mi">0</span>    <span class="mi">40</span>  <span class="mi">0</span>
<span class="n">cellBasisVector3</span> <span class="mi">0</span>    <span class="mi">0</span>   <span class="mi">40</span>
<span class="n">cellOrigin</span>       <span class="mi">0</span>    <span class="mi">0</span>   <span class="mi">0</span>
</code></pre></div> </div> </li> <li>Pressure Control - The ‚ÄòlangevinPiston‚Äô specifies whether the Langevin piston is to be used or not. ‚ÄòlangevinPistonTarget‚Äô specifies the target pressure required for the calculations involved in piston method, in bar. ‚ÄòlangevinPistonPeriod‚Äô specifies the duration for the piston method, in femtoseconds. ‚ÄòlangevinPistonDecay‚Äô - specifies the damping time period for the method, in femtoseconds. ‚ÄòlangevinPistonTemp‚Äô specifies the piston temperature, in Kelvin.</li> </ol> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">useGroupPressure</span>       <span class="n">yes</span>
<span class="n">useFlexibleCell</span>        <span class="n">no</span>
<span class="n">useConstantArea</span>        <span class="n">no</span>
<span class="n">LangevinPiston</span>         <span class="n">on</span>
<span class="n">LangevinPistonTarget</span>   <span class="mf">1.01325</span>
<span class="n">LangevinPistonPeriod</span>   <span class="mi">100</span>
<span class="n">LangevinPistonDecay</span>    <span class="mi">50</span>
<span class="n">LangevinPistonTemp</span>     <span class="mf">300.0</span>
</code></pre></div></div> <ol> <li>PME or Particle Mesh Ewald is used along side with periodic boundary conditions. ‚ÄòPMEGridSpacing‚Äô specifies the distance between the grids.</li> </ol> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PME</span>             <span class="n">yes</span>
<span class="n">PMEGridSpacing</span>  <span class="mi">2</span>
</code></pre></div></div> <ol> <li>Minimize - Performs the process of minimization, which refers to the process of changing the spatial arrangement of the atoms to lower the energy and to prevent bad contacts from occurring as soon as the simulation starts, for specified number of steps. <div class="language-python highlighter-rouge"> <div class="highlight"><pre class="highlight"><code><span class="n">minimize</span>       <span class="mi">5000</span>
</code></pre></div> </div> </li> <li>Run - The Run commands starts the simulation for a specified number of steps.</li> </ol> <p>In our case since we have to submit our job to a cluster we define multiple configuration files, this is done to so that if our system crashes at a certain point we can use the previous simulation output files rather than starting from scratch.</p> <p>Multiple files were created as part of the simulation, overall the simulation ran for 12 nanoseconds at 310 K.</p> <p>Now the batch file syntax looked as follows:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/bin/bash
#SBATCH -p compute
#SBATCH -N 1
#SBATCH -n 8
#SBATCH -t 120:00:00
#SBATCH --job-name="water_system"
#SBATCH -o slurm.%j.out
#SBATCH -e slurm.%j.err
#SBATCH --mail-user=email-id
#SBATCH --mail-type=ALL
</span>
<span class="c1">#module load namd-2.14-gcc-10.2.0-blihfvg
# module load openmpi-4.0.5-gcc-10.2.0-vx4yhsi
#module load namd-2.14-aocc-2.3.0-besm5io
#module load openmpi-4.0.5-aocc-2.3.0-kyn74k2
</span>
<span class="n">spack</span> <span class="n">load</span> <span class="n">namd</span> <span class="o">%</span><span class="n">aocc</span>

<span class="c1">#srun namd2 prod26.in&gt;prodout26
</span>
<span class="c1">#charmrun ++n 8 srun namd2 prod26.in &gt; out
</span><span class="n">namd2</span> <span class="o">+</span><span class="n">setcpuaffinity</span> <span class="o">+</span><span class="n">p8</span> <span class="n">eq1</span><span class="p">.</span><span class="ow">in</span> <span class="o">&gt;</span> <span class="n">out1</span>
<span class="n">mv</span> <span class="n">out1</span> <span class="n">output</span>
<span class="n">namd2</span> <span class="o">+</span><span class="n">setcpuaffinity</span> <span class="o">+</span><span class="n">p8</span> <span class="n">eq2</span><span class="p">.</span><span class="ow">in</span> <span class="o">&gt;</span> <span class="n">out2</span>
<span class="n">mv</span> <span class="n">out2</span> <span class="n">output</span>
<span class="n">namd2</span> <span class="o">+</span><span class="n">setcpuaffinity</span> <span class="o">+</span><span class="n">p8</span> <span class="n">eq3</span><span class="p">.</span><span class="ow">in</span> <span class="o">&gt;</span> <span class="n">out3</span>
<span class="n">mv</span> <span class="n">out3</span> <span class="n">output</span>
<span class="n">namd2</span> <span class="o">+</span><span class="n">setcpuaffinity</span> <span class="o">+</span><span class="n">p8</span> <span class="n">eq4</span><span class="p">.</span><span class="ow">in</span> <span class="o">&gt;</span> <span class="n">out4</span>
<span class="n">mv</span> <span class="n">out4</span> <span class="n">output</span>
</code></pre></div></div> <p>In here, first we write the settings that the systems needs to employ these include - number of cores, CPUs, job name (to keep track of job), name of output log file and name of output error file and finally mail (so that one knows when the job starts running and is completed). Following this, NAMD is loaded onto the cluster and finally run. Since the directory we are running on doesn‚Äôt have much of storage space, we move the files obtained after a run to a different directory to ensure that the system doesn‚Äôt run out of storage place.</p> <h2 id="files-and-further-analysis">Files and Further Analysis</h2> <p>The files for replicating the simulation are available <a href="https://github.com/AmiteshBadkul/water-box" target="_blank" rel="noopener noreferrer">here</a>. Furthermore, I utilized the output trajectory files to obtain the mean square displacement and further the diffusion coefficient, the blog post for the same is available <a href="https://amiteshbadkul.github.io/posts/2022/04/msd/">here</a>.</p> <h2 id="references">References</h2> <ol> <li><a href="http://li.mit.edu/A/Papers/05/Li05-2.8.pdf" target="_blank" rel="noopener noreferrer">Basic molecular dynamics</a></li> <li><a href="http://people.virginia.edu/~lz2n/mse627/Eduardo" target="_blank" rel="noopener noreferrer">Introduction to Atomistic Simulations</a></li> <li><a href="https://static.igem.org/mediawiki/2009/3/3e/Introduction_to_molecular_Dynamics_Simulation.pdf" target="_blank" rel="noopener noreferrer">Introduction to Molecular Dynamics Simulation - Michael P. Allen</a></li> <li><a href="http://fy.chalmers.se/~tfsgw/CompPhys/lectures/MD_LectureNotes_181111.pdf" target="_blank" rel="noopener noreferrer">Molecular Dynamics- Goran Wahnstrom</a></li> </ol> </article> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> ¬© Copyright 2025 Amitesh Badkul. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha256-fgLAgv7fyCGopR/gBNq2iW3ZKIdqIcyshnUULC4vex8=" crossorigin="anonymous"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js"></script> <script defer src="/assets/js/common.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> </body> </html>